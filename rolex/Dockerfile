FROM node:10

ENV PORT 80
ENV NODE_ENV production
ENV DB_HOST $HOST
ENV DB_PORT 3306
ENV DB_USER root
ENV DB_PASSWORD $PASSWORD
ENV ROLEX rolex_test
ENV AVENGERS entrydsm
ENV REDIS_HOST $HOST
ENV REDIS_PASSWORD $PASSWORD
ENV REDIS_PORT 6379
ENV JWTSECRET $JWTSECRET

RUN mkdir -p /rolex
WORKDIR /rolex
ADD . /rolex
RUN npm install

EXPOSE 80

CMD ["npm", "run prod"]